<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<title>README | @pwrs/cem</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.16.0/cdn/shoelace.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.16.0/dist/themes/light.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.16.0/dist/themes/dark.css">
<link id="hljs-light" rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11/styles/github.min.css" disabled>
<link id="hljs-dark"  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11/styles/github-dark.min.css" disabled>


<link rel="stylesheet" href="/cem/site.css">

<script type="module">
  import { setBasePath } from 'https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.16.0/dist/utilities/base-path.js';
  setBasePath('https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.16.0/dist/');
  const themeToggle = document.getElementById('theme-toggle');

  function setPrismTheme(dark, root = document) {
    // Prism theme switching
    const prismLight = root.getElementById('hljs-light');
    const prismDark = root.getElementById('hljs-dark');
    prismLight.disabled = dark;
    prismDark.disabled = !dark;
  }

  const updateTheme = () => {
    const dark = themeToggle.checked;
    document.body.setAttribute('class', dark ? 'sl-theme-dark' : 'sl-theme-light');
    setPrismTheme(dark);
  };

  themeToggle.addEventListener('sl-change', updateTheme);

  document.addEventListener('sl-after-show', async function(event) {
    await customElements.whenDefined('zero-md');
    await customElements.whenDefined('sl-spinner');
    const zeroMd = event.target.querySelector('zero-md');
    const spinner = event.target.querySelector('sl-spinner');
    if (spinner && zeroMd && !zeroMd.src) {
      zeroMd.src = zeroMd.dataset.src
      zeroMd.addEventListener('zero-md-rendered', function () {
        spinner.remove();
        updateTheme()
      }, { once: true })
    }
  });

  updateTheme();
</script>

</head>
<body>
  <header>
  <h2><code>@pwrs/cem</code></h2>
  <sl-switch id="theme-toggle" checked>Dark Mode</sl-switch>
</header>

<aside>
  <h2 id="navigation">Navigation</h2>
  <nav aria-labelledby="navigation">
    <a href="/cem/"><sl-icon name="house-door"></sl-icon> Home</a>
    <a href="/cem/benchmarks/"><sl-icon name="bar-chart"></sl-icon> Benchmarks</a>
  </nav>
</aside>




  <main>
    <article class="readme-content markdown-body">
      <h1>cem</h1>
<p><strong>cem</strong> is a command-line tool for generating <a href="https://github.com/webcomponents/custom-elements-manifest">Custom Elements Manifest</a>
(CEM) files from TypeScript sources. It analyzes your codebase and generates
rich metadata for your custom elements, facilitating documentation, tooling, and
integration.</p>
<blockquote>
<p>[!NOTE]
<code>cem</code> best supports LitElements written in idiomatic style with
TypeScript decorators. There is rudimentary support for <code>extends HTMLElement</code>,
but it is not a high priority for development. If you need something more
specific <a href="https://github.com/bennypowers/cem/issues/new">open an issue</a>.</p>
</blockquote>
<h2>Installation</h2>
<p>For go binaries:</p>
<pre class="language-sh"><code class="language-sh">go <span class="token function">install</span> bennypowers.dev/cem@latest
</code></pre>
<p>For NPM projects:</p>
<pre class="language-sh"><code class="language-sh"><span class="token function">npm</span> <span class="token function">install</span> --save-dev @pwrs/cem
</code></pre>
<p>Or clone this repository and build from source:</p>
<pre class="language-sh"><code class="language-sh"><span class="token function">git</span> clone https://github.com/bennypowers/cem.git
<span class="token builtin class-name">cd</span> cem
<span class="token function">make</span>
</code></pre>
<h2>Shell Completion</h2>
<p><code>cem</code> supports shell completion for Bash, Zsh, Fish, and PowerShell. The completion scripts provide tab completion for commands, flags, and file paths.</p>
<h3>Bash</h3>
<p>To load completions in your current shell session:</p>
<pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">source</span> <span class="token operator">&lt;</span><span class="token punctuation">(</span>cem completion <span class="token function">bash</span><span class="token punctuation">)</span>
</code></pre>
<p>To load completions for every new session, execute once:</p>
<p><strong>Linux:</strong></p>
<pre class="language-bash"><code class="language-bash">cem completion <span class="token function">bash</span> <span class="token operator">></span> /etc/bash_completion.d/cem
</code></pre>
<p><strong>macOS:</strong></p>
<pre class="language-bash"><code class="language-bash">cem completion <span class="token function">bash</span> <span class="token operator">></span> <span class="token variable"><span class="token variable">$(</span>brew <span class="token parameter variable">--prefix</span><span class="token variable">)</span></span>/etc/bash_completion.d/cem
</code></pre>
<h3>Zsh</h3>
<p>To load completions in your current shell session:</p>
<pre class="language-zsh"><code class="language-zsh">source &lt;(cem completion zsh)
</code></pre>
<p>To load completions for every new session, execute once:</p>
<pre class="language-zsh"><code class="language-zsh">cem completion zsh &gt; &quot;${fpath[1]}/_cem&quot;
</code></pre>
<p>You will need to start a new shell for this setup to take effect.</p>
<h3>Fish</h3>
<p>To load completions in your current shell session:</p>
<pre class="language-fish"><code class="language-fish">cem completion fish | source
</code></pre>
<p>To load completions for every new session, execute once:</p>
<pre class="language-fish"><code class="language-fish">cem completion fish &gt; ~/.config/fish/completions/cem.fish
</code></pre>
<h3>PowerShell</h3>
<p>To load completions in your current shell session:</p>
<pre class="language-powershell"><code class="language-powershell">cem completion powershell <span class="token punctuation">|</span> <span class="token function">Out-String</span> <span class="token punctuation">|</span> <span class="token function">Invoke-Expression</span>
</code></pre>
<p>To load completions for every new session, add the output of the above command to your PowerShell profile.</p>
<h2>Features</h2>
<h3><code>cem generate</code></h3>
<ul>
<li><strong>Generates CEM files</strong> from source code using syntax analysis powered by
<a href="https://go.dev">go</a> and <a href="https://tree-sitter.github.io/tree-sitter/">tree-sitter</a>.</li>
<li>Identifies custom elements, classes, variables, functions, and exports.</li>
<li>Supports elements written in idiomatic Lit typescript style, with a
<code>@customElement</code> decorator, and <code>@property</code> decorators on class fields.</li>
</ul>
<h4>JSDoc</h4>
<p>Use JSDoc comments to add metadata to your element classes, similar to other
tools. Add a description by separating the name of the item with <code>-</code></p>
<ul>
<li><code>@attr</code> / <code>@attribute</code> — Custom element attributes</li>
<li><code>@csspart</code> — CSS shadow parts</li>
<li><code>@cssprop</code> / <code>@cssproperty</code> — Custom CSS properties</li>
<li><code>@cssstate</code> — Custom CSS states</li>
<li><code>@demo</code> — Demo URL</li>
<li><code>@deprecated</code> — Marks a feature or member as deprecated</li>
<li><code>@event</code> — Custom events dispatched by the element</li>
<li><code>@slot</code> — Named or default slots</li>
<li><code>@summary</code> — Short summary for documentation</li>
</ul>
<p>See the <a href="tree/main/generate/test-fixtures/">test-fixtures</a> directory for examples</p>
<h4>HTML Template Analysis for Slots and Parts</h4>
<ul>
<li><strong>Automatically detects <code>&lt;slot&gt;</code> elements and <code>part</code> attributes in your element’s
<code>render()</code> template.</strong></li>
<li>Merges slot and part information found in templates with any provided
via JSDoc, ensuring comprehensive documentation in the generated manifest.</li>
<li><strong>Deprecation and other metadata</strong> for slots and parts can be specified via
YAML in HTML comments.</li>
<li><strong>Supports documenting slots and parts inline in your template HTML</strong> using
HTML comments with YAML blocks.</li>
<li>YAML comments are not necessary to detect slots and parts, but help in
documenting them for your users.</li>
</ul>
<h5>Examples</h5>
<pre class="language-html"><code class="language-html"><span class="token comment">&lt;!--
  summary: The main slot for content
  description: |
    This slot displays user-provided content.
    Supports multiline **markdown**.
  deprecated: true
--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
<span class="token comment">&lt;!-- slot:
       summary: Named slot summary
     part:
       summary: Part summary
--></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>slot</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>info<span class="token punctuation">"</span></span> <span class="token attr-name">part</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>info-part<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>slot</span><span class="token punctuation">></span></span>
</code></pre>
<h4>CSS Custom Properties</h4>
<p>Supports CSS Custom Properties by scanning css files and css tagged-template-literals</p>
<ul>
<li>Custom properties beginning with <code>_</code> will be ignored (treated as &quot;private&quot;)
e.g. <code>var(--_private)</code></li>
<li>If you provide a <a href="https://tr.designtokens.org/format/">Design Tokens Community Group</a> format module (JSON) to
<code>cem</code> via the <code>--design-tokens</code> flag,
<code>cem</code> will add metadata from your design system to any matching css variables it
finds in your elements</li>
<li>You can use jsdoc-like comment syntax before each var call to document your
variables</li>
</ul>
<h5>Example</h5>
<pre class="language-css"><code class="language-css"><span class="token selector">:host</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span>
    <span class="token comment">/**
     * custom color for use in this element
     * @summary color
     * @deprecated just use the `color` property
     */</span>
    <span class="token function">var</span><span class="token punctuation">(</span>--custom-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span>
    1px
    solid
    <span class="token comment">/** Border color of the element */</span>
    <span class="token function">var</span><span class="token punctuation">(</span>--border-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<hr>
<h4>Element Demos</h4>
<p><code>cem generate</code> supports documenting your elements' demos by linking directly
from JSDoc, or by configurable file-system based discovery.</p>
<h5>1. JSDoc <code>@demo</code> Tag</h5>
<p>Add demos directly to your element class or members with the <code>@demo</code> tag:</p>
<pre class="language-ts"><code class="language-ts"><span class="token comment">/**
 * @demo https://example.com/my-element-plain/
 * @demo https://example.com/my-element-fancy/ - A fancier demo with description
 */</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">customElement</span></span><span class="token punctuation">(</span><span class="token string">'my-element'</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">MyElement</span> <span class="token keyword">extends</span> <span class="token class-name">LitElement</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Demos defined this way will always appear in your manifest for the element.</p>
<h5>2. Demo Discovery</h5>
<p><code>cem</code> can automatically discover demos from your codebase based on your
repository structure and configuration.</p>
<h4>Demo Discovery Options</h4>
<p>Configure demo discovery with the <code>demoDiscovery</code> key in your <code>.config/cem.yaml</code> file</p>
<pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">sourceControlRootUrl</span><span class="token punctuation">:</span> <span class="token string">"https://github.com/your/repo/tree/main/"</span>
<span class="token key atrule">generate</span><span class="token punctuation">:</span>
  <span class="token key atrule">demoDiscovery</span><span class="token punctuation">:</span>
    <span class="token key atrule">fileGlob</span><span class="token punctuation">:</span> <span class="token string">"demos/**/*.html"</span>
    <span class="token key atrule">urlPattern</span><span class="token punctuation">:</span> <span class="token string">"demos/(?P&lt;tag>[\w-]+)/(?P&lt;demo>[\w-]+).html"</span>
    <span class="token key atrule">urlTemplate</span><span class="token punctuation">:</span> <span class="token string">"https://example.com/elements/{tag}/{demo}/"</span>
</code></pre>
<p><strong>Demo discovery options:</strong></p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>fileGlob</code></td>
<td>string</td>
<td>Glob pattern for discovering demo files.</td>
</tr>
<tr>
<td><code>sourceControlRootUrl</code></td>
<td>string</td>
<td>Canonical public source control URL for your repository root (on the main branch).</td>
</tr>
<tr>
<td><code>urlPattern</code></td>
<td>string</td>
<td>Pattern for generating demo URLs, e.g. <code>&quot;demos/{tag}.html&quot;</code>. <code>{tag}</code> is replaced by tag name.</td>
</tr>
<tr>
<td><code>urlTemplate</code></td>
<td>string</td>
<td>(optional) Alternative URL template for demo links.</td>
</tr>
</tbody>
</table>
<hr>
<h2>Configuration Reference</h2>
<p>You can configure CEM via <code>.config/cem.yaml</code>, relative to your project root,
or via CLI flags.</p>
<h3>Example Configuration</h3>
<pre class="language-yaml"><code class="language-yaml"><span class="token key atrule">sourceControlRootUrl</span><span class="token punctuation">:</span> <span class="token string">"https://github.com/your/repo/tree/main/"</span>
<span class="token key atrule">generate</span><span class="token punctuation">:</span>
  <span class="token key atrule">files</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">"src/**/*.ts"</span>
  <span class="token key atrule">exclude</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token string">"src/**/*.test.ts"</span>
  <span class="token key atrule">output</span><span class="token punctuation">:</span> <span class="token string">"custom-elements.json"</span>
  <span class="token key atrule">noDefaultExcludes</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
  <span class="token key atrule">designTokens</span><span class="token punctuation">:</span>
    <span class="token key atrule">spec</span><span class="token punctuation">:</span> <span class="token string">"npm:@my-ds/tokens/tokens.json"</span>
    <span class="token key atrule">prefix</span><span class="token punctuation">:</span> <span class="token string">"--my-ds"</span>
  <span class="token key atrule">demoDiscovery</span><span class="token punctuation">:</span>
    <span class="token key atrule">fileGlob</span><span class="token punctuation">:</span> <span class="token string">"demos/**/*.html"</span>
    <span class="token key atrule">urlPattern</span><span class="token punctuation">:</span> <span class="token string">"demos/(?P&lt;tag>[\w-]+)/(?P&lt;demo>[\w-]+).html"</span>
    <span class="token key atrule">urlTemplate</span><span class="token punctuation">:</span> <span class="token string">"https://example.com/elements/{tag}/{demo}/"</span>
</code></pre>
<hr>
<h2>Usage</h2>
<p>Generate a custom elements manifest from your files:</p>
<pre class="language-sh"><code class="language-sh">cem generate <span class="token punctuation">\</span>
  <span class="token string">"src/**/*.ts"</span> <span class="token punctuation">\</span>
  --design-tokens npm:@my-ds/tokens/tokens.json <span class="token punctuation">\</span>
  <span class="token parameter variable">--exclude</span> <span class="token string">"src/**/*.test.ts"</span> <span class="token punctuation">\</span>
  <span class="token parameter variable">--output</span> custom-elements.json
</code></pre>
<p>For npm projects you can use <code>npx @pwrs/cem generate ...</code>.</p>
<h3>Command Line Arguments</h3>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>&lt;files or globs&gt;</code></td>
<td>positional (array)</td>
<td>Files or glob patterns to include</td>
</tr>
<tr>
<td><code>--output, -o</code></td>
<td>string</td>
<td>Write the manifest to this file instead of stdout</td>
</tr>
<tr>
<td><code>--exclude, -e</code></td>
<td>array</td>
<td>Files or glob patterns to exclude</td>
</tr>
<tr>
<td><code>--no-default-excludes</code></td>
<td>bool</td>
<td>Do not exclude files by default (e.g., <code>.d.ts</code> files will be included unless excluded explicitly)</td>
</tr>
<tr>
<td><code>--design-tokens, -t</code></td>
<td>string</td>
<td>Path or npm specifier for DTCG-format design tokens</td>
</tr>
<tr>
<td><code>--design-tokens-prefix, -p</code></td>
<td>string</td>
<td>CSS custom property prefix for design tokens</td>
</tr>
<tr>
<td><code>--demo-discovery-file-glob</code></td>
<td>string</td>
<td>Glob pattern for discovering demo files</td>
</tr>
<tr>
<td><code>--demo-discovery-url-pattern</code></td>
<td>string</td>
<td>Go Regexp pattern with named capture groups for generating canonical demo urls</td>
</tr>
<tr>
<td><code>--demo-discovery-url-template</code></td>
<td>string</td>
<td>URL pattern string using {groupName} syntax to interpolate named captures from the URL pattern</td>
</tr>
<tr>
<td><code>--source-control-root-url</code></td>
<td>string</td>
<td>Glob pattern for discovering demo files</td>
</tr>
<tr>
<td><code>--project-dir</code></td>
<td>string</td>
<td>Specify the project root directory to use for resolving relative paths and configuration.</td>
</tr>
</tbody>
</table>
<p>By default, some files (like <code>.d.ts</code> TypeScript declaration files) are excluded from the manifest.
Use <code>--no-default-excludes</code> if you want to include all matching files and manage excludes yourself.</p>
<h2>Contributing</h2>
<p>For information on building and testing, please see
<a href="./CONTRIBUTING.md">CONTRIBUTING.md</a>.</p>
<h2>License</h2>
<p>This program is free software: you can redistribute it and/or modify it under
the terms of the <a href="https://www.gnu.org/licenses/gpl-3.0.html">GNU General Public License v3.0</a>.</p>
<p>© 2025 Benny Powers <a href="mailto:web@bennypowers.com">web@bennypowers.com</a></p>

    </article>
  </main>

  
</body>
</html>
