// Generated by cem export - do not edit
import {
  Component,
  ElementRef,
  EventEmitter,
  inject,
  Input,
  Output,
  AfterViewInit,
  OnChanges,
  OnDestroy,
  SimpleChanges,
  CUSTOM_ELEMENTS_SCHEMA,
} from '@angular/core';
import '{{ .ImportPath }}';

/** {{ .Summary }} */
@Component({
  selector: '{{ .TagName }}',
  standalone: true,
  schemas: [CUSTOM_ELEMENTS_SCHEMA],
  template: `
{{- if .HasDefaultSlot }}
    <ng-content></ng-content>
{{- end }}
{{- range .Slots }}
{{- if .Name }}
    <ng-content select="[slot={{ .Name }}]"></ng-content>
{{- end }}
{{- end }}
  `,
})
export class {{ .ComponentName }}Component implements AfterViewInit, OnChanges, OnDestroy {
  private elRef = inject(ElementRef<HTMLElement>);

{{- range .Attributes }}
  /** {{ .Summary }} */
  @Input() {{ .Name | or .FieldName }}{{ if .IsBoolean }}: boolean = false{{ else }}?: {{ .Type }}{{ end }};
{{- end }}

{{- range .Properties }}
  /** {{ .Summary }} */
  @Input() {{ .Name }}?: {{ .Type }};
{{- end }}

{{- range .Events }}
  /** {{ .Summary }} */
  @Output() {{ .AngularName }} = new EventEmitter<{{ .Type }}>();
{{- end }}

  private listeners: (() => void)[] = [];

  ngAfterViewInit(): void {
    const el = this.elRef.nativeElement;
{{- range .Events }}
    {
      const handler = (event: Event) => this.{{ .AngularName }}.emit(event as {{ .Type }});
      el.addEventListener('{{ .Name }}', handler);
      this.listeners.push(() => el.removeEventListener('{{ .Name }}', handler));
    }
{{- end }}
  }

  ngOnChanges(changes: SimpleChanges): void {
    const el = this.elRef?.nativeElement;
    if (!el) return;
{{- range .Attributes }}
{{- if .IsBoolean }}
    if (changes['{{ .Name | or .FieldName }}']) {
      if (this.{{ .Name | or .FieldName }}) {
        el.setAttribute('{{ .Name }}', '');
      } else {
        el.removeAttribute('{{ .Name }}');
      }
    }
{{- else }}
    if (changes['{{ .Name | or .FieldName }}']) {
      if (this.{{ .Name | or .FieldName }} != null) {
        el.setAttribute('{{ .Name }}', String(this.{{ .Name | or .FieldName }}));
      } else {
        el.removeAttribute('{{ .Name }}');
      }
    }
{{- end }}
{{- end }}
{{- range .Properties }}
    if (changes['{{ .Name }}']) (el as any).{{ .Name }} = this.{{ .Name }};
{{- end }}
  }

  ngOnDestroy(): void {
    this.listeners.forEach(fn => { fn(); });
    this.listeners = [];
  }
}
